# 1. 노드의 정의

## 공식 홈페이지의 설명

Node.js는 크롬 V8 자바스크립트 엔진으로 빌드된 자바스크립트 런타임이다.<br>
즉, 노드는 서버가 아닙니다.

> 런타임이란? : 정말 쉽게 말해 실행기라고 할 수 있다.

## 노드는 서버가 아닌가요?

- 서버의 역활도 수행할 수 있는 자바스크립트 런타임
- 노드로 자바스크립트로 작성된 서버를 실행할 수 있음.
- 서버 실행을 위해 필요한 http/https/http2 모듈을 제공

> 노드는 그냥 하나의 런타임이고, 서버의 역활도 수행할 수 있을뿐이다.

<br>

# 2. 런타임

## 노드: 자바스크립트 런타임

- 런타임: 특정 언어로 만든 프로그램들을 실행할 수 있게 해주는 가상 머신(크롬의 V8 엔진 사용)의 상태
- 노드: 자바스크립트로 만든 프로그램들을 실행할 수 있게 해 줌
- 다른 런타임으로는 웹 브라우저가 있음.
- 노드 이전에도 자바스크립트 런타임을 만들기 위한 많은 시도
- But, 엔진 속도 문제로 실패

<br>

# 3. 내부 구조

- 대부분 C나 C++로 구현이 되어있다.
- V8 엔진: 오픈 소스 자바스크립트 엔진 -> 속도 문제 개선
- libuv: 노드의 특성인 이벤트 기반, 논블로킹(비동기) I/O 모델을 구현한 라이브러리

## 1. 이벤트 기반

### 이벤트가 발생할 떄 미리 지정해둔 작업을 수행하는 방식

- 이벤트의 예: 클릭, 네트워크 요청, 타이머 등
- 이벤트 리스너: 이벤트를 등록하는 함수
- 콜백 함수: 이벤트가 발생했을 때 실행될 함수

<br>

## 2. 논블로킹(비동기) I/O

> 블로킹은 동기라고 볼 수 도 있다.

### 논 블로킹: 오래 걸리는 함수를 백그라운드로 보내서 다음 코드가 먼저 실행되게 하고, 나중에 오래 걸리는 함수를 실행

- 논 블로킹 방식 하에서 일부 코드는 백그라운드에서 병렬로 실행됨
- 일부 코드: I/O 작업(파일 시스템 접근, 네트워크 요청), 압축, 암호화 등
- 나머지 코드는 블로킹 방식으로 실행됨
- I/O 작업이 많을 때 노드 활용성이 극대화

<br>

**동기 & 비동기**
<br>
동기: 코드가 순서대로 실행된다. (블로킹)
비동기 : 코드가 순서대로 실행되지 않은다. (논블로킹)

<br>

## 3. 프로세스 vs 스레드

### 프로세스와 스레드

- 프로세스: 운영체제에서 할당하는 작업의 단위, 프로세스 간 자원공유 안됨.
- 스레드: 프로세스 내에서 실행되는 작업의 단위, 부모 프로세스 자원공유

### 노드는 싱글 스레드라고 하던데?

- 노드 프로세스는 멀티 스레드이지만 직접 다룰 수 있는 스레드는 하나이기 때문에 싱글 스레드라고 표현됨
- 노드는 주로 멀티 스레드 대신 멀티 프로세스 활용
- 노드는 14버전부터 멀티 스레드 사용 가능

### 멀티 스레딩의 장점

- 동시에 여러가지 작업을 할 수 있다.

### 멀티 스레딩의 단점

- 프로그래밍이 어렵다.

## 4. 싱글 스레드

스레드 하나는 CPU의 코어 하나를 잡아먹는다.

### 싱글 스레드라 주어진 일을 하나 밖에 처리하지 못함

- 블로킹이 발생하는 경우 나머지 작업은 모두 대기해야 함 -> 비효율 발생, 즉 효율 적인 구조는 아니다.
- 만약 32코어인데 싱글스레드다? 그러면 코어 하나만 오지게 돌아가고, 나머지는 얼음짱 처럼 차가움(안돌아가서)

<br>

**결론적으로는 싱글스레드를 잘다룰줄 알면 된다~**

# 4. 서버로서의 노드

### 서버: 네트워크를 통해 클라이언트에 정보나 서비스를 제공하는 컴퓨터 또는 프로그램

### 클라이언트: 서버에 요청을 보내는 주체(부라우저, 데스트탑 프로그램, 모바일 앱) : 다른 서버에 요청을 보내는 서버

노도는 서버가 아니다!!! 하지만 노드는 서버를 구성할 수 있게 하는 모듈을 제공합니다. <br>
<span style="color:yellow">즉, 쉽게 말하면 노드 덕분에 내 컴퓨터가 서버가 되는거다!</span>

## 노드 서버의 장단점

> 자바스크립트 장단점과 거의 흡사하다고 볼 수 있다

| 장점                                             | 단점                                         |
| ------------------------------------------------ | -------------------------------------------- |
| 멀티스레드 방식에 비해 컴퓨터 자원을 적게 사용함 | 싱글스레드라서 CPU 코어를 하나만 사용함      |
| I/O 작업이 많은 서버로 취합                      | CPU 작업이 많은 서버로는 부적합              |
| 멀티 스레드 방식보다 쉬움                        | 하나뿐인 스레드가 멈추기 않도록 관리해야함   |
| 웹 서버가 내장 되어 있음                         | 서버 규모가 커졌을 때 서버를 관리하기 어려움 |
| 자바스크립트를 활용함                            | 어중간한 성능                                |
| JSON 형식과 호환하기 쉬움                        |                                              |

## CPU 작업을 위해

AWS Lambda나 Google Cloud Functions 같은 별도 서비스 사용

> 노드의 적은 Deno, Deno는 node를 없앨 수 있는 막강한 힘이 있다.(근데 그럴 가능성은 없음)
